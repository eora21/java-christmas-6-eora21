# 요구사항
## 메뉴 구현
- [x] 애피타이저 메뉴를 구현한다.
	- 양송이수프(6,000)
	- 타파스(5,500)
	- 시저샐러드(8,000)
- [x] 메인 메뉴를 구현한다.
	- 티본스테이크(55,000)
	- 바비큐립(54,000)
	- 해산물파스타(35,000)
	- 크리스마스파스타(25,000)
- [x] 디저트 메뉴를 구현한다.
	- 초코케이크(15,000)
	- 아이스크림(5,000)
- [x] 음료 메뉴를 구현한다.
	- 제로콜라(3,000)
	- 레드와인(60,000)
	- 샴페인(25,000)
## 이벤트 구현
- [ ] **이벤트는 총주문 금액 10,000원 이상부터 적용**되어야 한다.
- [ ] 크리스마스 디데이 할인을 구현한다.
	- [ ] 이벤트 기간은 **1일부터 25일까지**이다.
	- [ ] **1,000원으로 시작**하여 날이 지날 때마다 **할인 금액이 100원씩 증가**한다.
	- [ ] 할인은 **총주문 금액에서 해당 금액만큼 할인**한다.
- [ ] 평일 할인을 구현한다.
	- [ ] 이벤트 기간은 **1일부터 31일까지**이다.
	- [ ] 이벤트 요일은 **일요일부터 목요일까지**이다.
	- [ ] **디저트** 메뉴 **1개당 2,023원 할인**한다.
- [ ] 주말 할인을 구현한다.
	- [ ] 이벤트 기간은 **1일부터 31일까지**이다.
	- [ ] 이벤트 요일은 **금요일, 토요일**이다.
	- [ ] **메인** 메뉴 **1개당 2,023원 할인**한다.
- [ ] 특별 할인을 구현한다.
	- [ ] 이벤트 기간은 **1일부터 31일까지**이다.
	- [ ] 이벤트 일자는 **이벤트 달력에 별이 있는 날짜**(3일, 10일, 17일, 24일 ,25일, 31일)이다.
	- [ ] 할인은 **총주문 금액에서 1,000원 할인**한다.
- [ ] 증정 이벤트를 구현한다.
	- [ ] **할인 전 총주문 금액**이 **120,000원 이상**일 때 음료 메뉴의 **샴페인을 증정**한다. 
## 이벤트 배지 부여
- [ ] 총혜택 금액(할인 금액의 합계 + 증정 메뉴의 가격)에 따라 이벤트 배지를 부여한다.
	- [ ] 5,000원 이상일 때는 별을 부여한다.
	- [ ] 10,000원 이상일 때는 트리를 부여한다.
	- [ ] 20,000원 이상일 때는 산타를 부여한다.
- [ ] 이벤트 배지를 구현한다.
	- 별
	- 트리
	- 산타
## 주문 구현
- [ ] 우테코 식당 이벤트 플래너 안내메시지를 출력한다.
- [ ] 식당 방문 날짜를 입력받는다.
	- [ ] 식당 방문 날짜 입력 안내메시지를 출력한다.
	- [ ] 입력을 숫자로 변환해 반환한다.
		- [ ] 1 이상 31 이하의 숫자가 아닌 경우 유효하지 않은 날짜 예외 메시지를 출력한다.
- [ ] 주문받을 메뉴 및 개수를 입력받는다.
	- [ ] 주문 메뉴 및 개수 입력 안내메시지를 출력한다.
	- [ ] 입력을 구분하여 반환한다.
		- [ ] 주문들은 쉼표를 기준으로 나눈다.
		- [ ] 메뉴와 메뉴의 개수는 '-'를 기준으로 나눈다.
		- [x] 음료만 주문 시 주문할 수 없다는 예외를 발생시킨다.
		- [x] 메뉴의 개수가 1 미만일 경우 유효하지 않은 주문 예외 메시지를 발생시킨다.
		- [ ] 메뉴의 형식이 예시와 다른 경우 유효하지 않은 주문 예외 메시지를 발생시킨다.
		- [x] 중복 메뉴를 입력한 경우 유효하지 않은 주문 예외 메시지를 발생시킨다.
		- [x] 메뉴의 개수 총 합이 20개 초과일 경우 예외를 발생시킨다.
- [ ] 이벤트 혜택 미리 보기를 출력한다.
	- [ ] 주문 메뉴들을 출력한다.
		- [ ] 출력 순서는 자유롭게 한다.
	- [ ] 할인 전 총주문 금액을 출력한다.
	- [ ] 증정 메뉴를 출력한다.
		- [ ] 증정 이벤트에 해당하지 않는 경우, 증정 메뉴 "없음"으로 보여준다.
	- [ ] 혜택 내역을 출력한다.
		- [ ] 현재 주문으로 인한 고객에게 적용된 이벤트 내역만 보여준다.
		- [ ] 혜택이 없는 경우 "없음"으로 보여준다.
		- [ ] 출력 순서는 자유롭게 한다.
	- [ ] 총혜택 금액을 출력한다.
		- [ ] 총혜택 금액은 할인 금액의 합계 + 증정 메뉴의 가격이다.
	- [ ] 할인 후 예상 결제 금액을 출력한다.
		- [ ] 할인 후 예상 결제 금액은 할인 전 총주문 금액 - 할인 금액이다.
	- [ ] 이벤트 배지를 출력한다.
		- [ ] 이벤트 배지가 부여되지 않는 경우 "없음"으로 보여준다.
- [ ] 모든 예외메시지 앞에는 "[ERROR]"를 출력한다.
# 필요한 기능
- [ ] 입력받은 날짜를 기반으로 요일을 획득한다.
- [ ] 적용될 이벤트 목록을 가져온다.
- [ ] 메뉴 및 할인전 총주문 금액을 바탕으로 적용 내역을 가져온다.
	- [ ] 증정 메뉴를 가져온다.
	- [ ] 혜택 내역을 가져온다.
	- [ ] 할인 금액을 가져온다.
---
# 고민한 사항들

## 확장 가능한 구조
해당 애플리케이션이 2023년 12월만 타겟으로 한 게 아닌, 다음에도 사용될 수 있을 거라는 생각을 했습니다. 따라서 주어진 조건들을 잘 추상화하되, 최대한 확장에 열려있는 구조를 갖추고자 노력했습니다.
## 메뉴를 어떻게 구조화할 것인가
메뉴들은 특정 그룹으로 나뉘어지고 있습니다. 해당 그룹들의 분류를 구현하되, 모든 메뉴들을 한 곳에서 접근할 방법을 모색했습니다.
이에 세가지 방법을 고민했습니다.
### Menu abstract class를 만든 후 extends
메뉴 가상 클래스에서 각각 구성에 필요한 필드를 작성 및 강제할 수 있습니다.
예로 메뉴에 이름과 가격 필드를 작성하고, 이를 생성자로 넣어주게 한다면 다른 클래스들은 이러한 형태를 무조건 따라야 하고, 각각의 필드값이 무조건 존재함을 예측할 수 있습니다. 또한 생성자 내부에 메뉴 목록 업데이트 코드를 첨부하면 모든 메뉴들의 구현체들을 자연스레 모을 수 있을 것입니다.
### Menu interface를 만든 후 각각의 enum 그룹에서 implements
메뉴 인터페이스에서 이름, 가격을 반환하게 강제합니다.
각각의 enum은 객체들을 작성하되, 내부 형태는 비교적 자유롭게 가져갈 수 있습니다. 이름과 가격에 대해 필드를 강제하지 않기 때문입니다. 다만 각각의 반환값만 제대로 맞춰주면, 내부적으로 어떤 설계를 가져간다 한들 문제될 일이 없습니다.
### Menu enum을 만들고 생성자 파라미터로 그룹 정보 제공
전체의 메뉴를 기입하고, 파라미터로 각 음식의 해당 그룹을 정의하는 방법입니다.
구현이 가장 쉽고 간편하나, 특정 변동이 생기는 경우(예: 세트메뉴 추가) 평등관계가 깨져 enum을 각각 쪼개 구현하거나, 해당 enum 객체들의 목록을 갖는 다른 클래스를 구현하거나, 아니면 enum의 필드값들을 변동시켜야 합니다. 즉, 확장성이 제일 낮습니다.

처음엔 enum과 interface의 조합을 시도하기 위해 두번째 방법을 사용하는 방향을 선택했습니다.
다만 각각의 인스턴스가 만들어질 때마다 메뉴 목록에 추가하기 위해서는 생성자에 해당 동작을 위한 메서드를 작성해야 했는데, 이를 누락할 가능성이 있었습니다. 즉, 해당 로직을 강제할 방법이 없어 보였습니다.
ServiceLoader를 사용하면 된다고는 하나 이 또한 그룹이 늘어날 경우 강제적인 관리가 필요해야 했기에 선택하지 않았습니다.

이에 첫번째 방법을 선택하였으나, enum처럼 활용하기 위해선 상속받은 클래스마다 상수 인스턴스를 지니고 있어야 했습니다. 허나 이는 해당 클래스가 로딩이 선행되어야만 인스턴스가 생성됨을 보장할 수 있습니다. 따라서 잘못하면 원치 않는 동작이 일어날 수 있었습니다. 자식 클래스를 메모리에 올리는 초기 로딩 과정이 있으면 해결되겠지만 이를 따로 구현하는 것 자체가 동작을 강제할 힘이 없음을 보이는 것이라 생각했습니다.
또한, 부모 클래스에서만 static 메서드를 동작시키고 싶어도 자식 클래스 또한 권한을 갖기에 어떤 식으로 접근해도 허용된다는 문제가 있습니다. 물론 자식 클래스로도 접근하는 게 큰 문제가 되지 않을 수 있겠지만, 최대한 코드를 깔끔하게 가져가며 오남용을 방지하고자 했습니다.

따라서 마지막 세번째 방법을 선택하여 구현하기로 하였습니다.
해당하는 방법은 확장성이 낮지만 제일 단순하면서도, 현재 고민중인 내용들을 최대한 쉽게 가져갈 수 있었습니다.

## 이벤트를 어떻게 구조화할 것인가
메뉴처럼 이벤트를 Enum으로 구조화한다면 각각을 싱글턴으로 유지할 수 있고, 목록을 가져오는 것도 손쉽게 할 수 있습니다.
다만 단점은, Enum의 책임이 너무 커질 수 있다는 점입니다.
하나의 Enum에 각각의 이벤트 구현체를 위해 특정 메서드를 작성해야 하는데, 함수형을 아무리 잘 사용한다 해도 이벤트의 수가 많아지면 많아질 수록 메서드들의 종류가 급격히 늘어날 것입니다.

현재 주어진 이벤트를 추상화해보면 다음과 같습니다.
- 이벤트의 기간을 지니고 있습니다.
- 특정 날짜를 기반으로 이벤트가 수행될 수 있는지 파악합니다.
- 내부적인 로직을 통해 이벤트를 수행합니다.
	- 메뉴 그룹과 속한 개수에 따라 할인됩니다.
	- 날짜를 기반으로 총주문 금액에서 할인됩니다.
	- 할인 전 총주문 금액을 기반으로 특정 품목이 증정됩니다.
### 증정과 할인을 통한 가능성과 다양성 유추
이벤트 중 증정은 특정 메뉴를 제공하고, 메뉴 가격만큼 혜택 내역에서 가격을 표기해야 했습니다.
다만 할인은 실제 금액에서 얼마나 차감될지를 표기해야 했습니다.
따라서 이 둘을 실질적으로 구분해야 했습니다. 물론 함수형을 잘 이용하면 문제 없이 진행될 수 있으나, 만약 여러 종류의 이벤트들이 생길 경우 Enum의 구조가 계속 바뀌거나 쪼개야 한다고 판단했습니다. 비교적 제약이 있는 메뉴보다, 훨씬 많은 가능성과 다양성을 지닌 것이 이벤트라 생각했기 때문입니다.
예로, 이벤트 배지 부여도 하나의 이벤트로 본다면 이는 Enum으로 추가 구현하기 어려워질 수 있습니다. 추상화를 다시 하여, 공통점을 다시 이끌어야 하기 때문입니다.

따라서 이번에는 Enum을 사용하지 않을 생각이었습니다.
그러나, 똑같은 고민에 봉착했습니다.
## 클래스 동적 로딩 타이밍은 어떻게 해결할 것인가
메뉴를 구성할 때와 같은 문제가 생겼습니다. 아무리 잘 구조화한다 해도, 결국 클래스가 로딩되지 않으면 동작되지 않습니다.
싱글턴으로 생성하여 이벤트 목록에 넣어두겠다! 라고 생각해도 결국 메인 스레드가 클래스의 인스턴스를 생성하거나, 정적 변수를 사용하거나, 정적 메서드를 호출하지 않으면 소용이 없는 것입니다.
즉 메인에서 해당 이벤트들을 강제로 생성 혹은 인스턴스를 얻어와 묶어주거나, 특정 메서드를 호출시켜야 한다는 것을 뜻합니다.
이는 프로그래머의 코드 강제를 뜻하고, 실수할 가능성이 생기므로, 계속 고민을 지속했습니다.
### 생성 자체는 Enum에 맞기고, 각각의 싱글턴을 유지하면?
Enum을 통해 해당 이벤트의 실행 기간(이벤트 시작일, 종료일)을 지정하고, 각 이벤트의 인스턴스만 얻어옵니다. 이벤트 기간은 각 이벤트마다 필수적으로 지닐, 혹은 항시 유지라 하더라도 기간을 굉장히 넓게 잡으면 되기 때문에 최대한의 추상화를 통한 공통 인자입니다.
이벤트들은 본인의 이벤트에 대한 행동을 각각의 클래스에서 구현하되, 시작일과 종료일을 기입하기 위해선 Enum에 작성해야 합니다.
메인에서는 해당 Enum의 이벤트 모음 메서드를 동작시키고, Enum의 객체들이 생성되며 인스턴스를 얻어옵니다.
해당하는 방법이 이벤트를 강제로 생성하는 코드보다 오히려 더 깔끔하고, 프로그래머가 실수할 여지를 많이 남기지 않는다 생각했습니다.
(Package 클래스를 통해 이벤트 패키지 내의 클래스 목록을 가져와 강제로 동작시키는 방법도 있는 것 같으나, 제대로 된 이해 없이 사용하고 싶지 않았습니다. 또한 구조적으로 동작을 강제하는 게 아닌 클래스에 함부로 접근하여 동작시키는 것이기에 조심스러웠습니다.)
## 예외 메시지
날짜 입력 중 숫자 변환 실패, 1 이상 31 이하가 아닌 값의 경우에는 `[ERROR] 유효하지 않은 날짜입니다. 다시 입력해 주세요.`가 출력되어야 합니다.
주문 시에는 메뉴 오입력, 메뉴 개수 0 이하, 메뉴 형식이 예시와 다른 경우, 메뉴가 중복된 경우에 `[ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요.`가 출력되어야 합니다.
그러나 고객에게 안내할 이벤트 주의 사항에는 총주문 금액 만원 미만 이벤트 미적용, 음료만 주문 시 주문 불가, 주문 메뉴 최대 개수 20개라는 안내가 있습니다.
총주문 만원 미만은 예시에서도 나와있듯 정상 작동하여야 하며, 나머지 둘은 재주문을 요청해야 했습니다.
그러나 셋 다 '안내할 주의 사항'이므로 예외 메시지 출력이 '유효하지 않은 주문'으로 나와서는 안된다 생각했습니다.
따라서 (출력 문구에는 없지만) 만원 이하 주문 시 이벤트 미적용이라는 안내를 띄우되 혜택 미리보기까지 넘어가고, 나머지 둘은 정확한 안내문구 출력과 더불어 재주문을 받아야 할 것이라는 결정을 했습니다. 기능 요구 사항 중 '필요하다면 주어진 문제의 내용을 통해 유추하고 스스로 판단해 구현'하라는 문구를 통해 이처럼 생각했습니다.
나머지의 예외 사항에 대해서도 정확한 메시지를 띄울 수 있다면 좋겠으나, 우선은 요구사항에 적힌 대로 동작하게끔 만들어야겠다고 생각했습니다.